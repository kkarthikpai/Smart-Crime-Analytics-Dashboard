<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Top Cities by Crime - Dashboard</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    
    <style>
        body { margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f4f6f9; color: #333; }
        .navbar { display: flex; justify-content: space-between; align-items: center; background: #1a237e; padding: 10px 20px; color: white; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); position: sticky; top: 0; z-index: 20; }
        .navbar h1 { margin: 0; font-size: 24px; font-weight: 600; }
        .nav-links { display: flex; gap: 25px; }
        .nav-links a { color: white; text-decoration: none; font-size: 16px; transition: color 0.3s; }
        .nav-links a:hover { color: #a5d6a7; }
        .dropdown { position: relative; display: inline-block; }
        .dropbtn { background: none; border: none; color: white; font-size: 16px; cursor: pointer; padding: 0; }
        .dropdown-content { display: none; position: absolute; background: white; min-width: 200px; box-shadow: 0px 8px 16px rgba(0,0,0,0.2); z-index: 10; right: 0; }
        .dropdown-content a { color: #333; padding: 12px 16px; text-decoration: none; display: block; }
        .dropdown-content a:hover { background: #e0e0e0; }
        .dropdown:hover .dropdown-content { display: block; }

        .dashboard-container { padding: 20px; max-width: 1000px; margin: 20px auto; background: #fff; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05); }
        .chart-area { height: 450px; }
        h2 { color: #1a237e; border-bottom: 2px solid #a5d6a7; padding-bottom: 10px; margin-top: 0; font-size: 24px; text-align: center; }
    </style>
</head>
<body>
    <div class="navbar">
        <h1>Smart Crime Analytics Dashboard</h1>
        <div class="nav-links">
            <a href="index.html">Home</a>
            <div class="dropdown">
                <button class="dropbtn">Analytics â–¼</button>
                <div class="dropdown-content">
                    <a href="yearly_trend.html">Crime Trend (Yearly)</a>
                    <a href="top_crimes.html">Top Crime Types</a>
                    <a href="top_cities.html" style="background: #e0e0e0; color: #1a237e; font-weight: bold;">City Hotspots</a>
                    <a href="district_analysis.html">District Analysis</a> 
                </div>
            </div>
            <a href="about.html">About</a>
        </div>
    </div>

    <div class="dashboard-container">
        <h2>Total IPC Incidents by Metropolitan City (2022)</h2>
        <div class="chart-area">
            <canvas id="topCitiesChart"></canvas>
        </div>
        </div>

    <script>
        // Red/Maroon gradient colors (Darkest to Lightest for Top 10)
        const RED_GRADIENT_COLORS = [
            'rgba(136, 0, 0, 0.9)',   // 1. Darkest
            'rgba(150, 15, 15, 0.9)', 
            'rgba(165, 30, 30, 0.9)', 
            'rgba(180, 45, 45, 0.9)', 
            'rgba(195, 60, 60, 0.9)', 
            'rgba(210, 75, 75, 0.9)', 
            'rgba(225, 90, 90, 0.9)', 
            'rgba(240, 105, 105, 0.9)', 
            'rgba(255, 120, 120, 0.9)',
            'rgba(255, 135, 135, 0.9)'  // 10. Lightest
        ];
        // Border colors are the same shades but full opacity
        const BORDER_GRADIENT_COLORS = RED_GRADIENT_COLORS.map(c => c.replace('0.9', '1'));

        // Updated data for all metropolitan cities (new data from uploaded file)
        const topCitiesData = [
            { city: 'Delhi', count: 298988 },
            { city: 'Mumbai', count: 69289 },
            { city: 'Bengaluru', count: 28666 },
            { city: 'Jaipur', count: 28171 },
            { city: 'Ahmedabad', count: 22872 },
            { city: 'Hyderabad', count: 20668 },
            { city: 'Indore', count: 16636 },
            { city: 'Lucknow', count: 15115 },
            { city: 'Chennai', count: 15086 },
            { city: 'Kochi', count: 13273 },
            { city: 'Nagpur', count: 12889 },
            { city: 'Patna', count: 12522 },
            { city: 'Kanpur', count: 11721 },
            { city: 'Pune', count: 11074 },
            { city: 'Kolkata', count: 11038 },
            { city: 'Surat', count: 9872 },
            { city: 'Ghaziabad', count: 9860 },
            { city: 'Kozhikode', count: 8074 },
            { city: 'Coimbatore', count: 4542 }
        ].sort((a, b) => b.count - a.count);

        function renderChart() {
            // Only take the top 10 cities for the chart
            const top10CitiesData = topCitiesData.slice(0, 10);

            const labels = top10CitiesData.map(d => d.city);
            const dataCounts = top10CitiesData.map(d => d.count);

            const ctx = document.getElementById('topCitiesChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Total Incidents',
                        data: dataCounts,
                        // Use the gradient colors
                        backgroundColor: RED_GRADIENT_COLORS,
                        borderColor: BORDER_GRADIENT_COLORS,
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y', // Horizontal bar chart
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { // X-axis is now for counts
                            beginAtZero: true,
                            title: { display: true, text: 'Total Incidents', font: { size: 14 } }
                        },
                        y: { // Y-axis is now for cities
                            title: { display: true, text: 'City', font: { size: 14 } }
                        }
                    },
                    plugins: { 
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    // Check context.parsed.x for horizontal chart
                                    if (context.parsed.x !== null) {
                                        label += context.parsed.x.toLocaleString();
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        document.addEventListener('DOMContentLoaded', renderChart);
    </script>
</body>
</html>